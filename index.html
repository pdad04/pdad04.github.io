<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="styles.css" />
    <script>
      (function (h, o, u, n, d) {
        h = h[d] = h[d] || {
          q: [],
          onReady: function (c) {
            h.q.push(c);
          },
        };
        d = o.createElement(u);
        d.async = 1;
        d.src = n;
        n = o.getElementsByTagName(u)[0];
        n.parentNode.insertBefore(d, n);
      })(
        window,
        document,
        "script",
        "https://www.datadoghq-browser-agent.com/us1/v6/datadog-rum.js",
        "DD_RUM"
      );
      fetch("https://catfact.ninja/fact")
        .then(r => r.json())
        .then(data => {
          console.log("catFact early:", data.fact);
        });
      
      window.DD_RUM.onReady(function () {
        window.DD_RUM.init({
          clientToken: "pubb8acb34d3c0e6dfec4de976d3ee64de7",
          applicationId: "0fa0a8e0-e772-405e-851e-bf0284e91922",
          site: "datadoghq.com",
          service: "test",
          env: "test",
          version: "1",
          sessionSampleRate: 100,
          sessionReplaySampleRate: 100,
          trackAnonymousUser: true,
          startSessionReplayRecordingManually: true,
          // trackEarlyRequests: true,
          // trackViewsManually: true
          sessionPersistence: "local-storage    "
      })
    })
    </script>
</head>
 <body>
    <div class="main-container">
      <h1>Webviews in iOS</h1>
      <p>
        This page demonstrates a Webview in an iOS app that is instrumented with
        <a href="https://docs.datadoghq.com/real_user_monitoring/">
          Datadog RUM</a
        >
      </p>
    </div>
    <div>
      <a href="about.html">About Page</a>
    </div>

    <button id="colorChange" onclick="colorChange()">
      Change Background Color
    </button>
    <button onclick="getFact()">
      Get Cat Fact
    </button>
    <button onclick="doNothing()">
      Do Nothing
    </button>
    <div>
      <p id="catfact"></p>
    <div>
      
    <script>
      const body = document.getElementsByTagName("body")[0];
      const colors = [
        "Beige",
        "AliceBlue",
        "Aqua",
        "CadetBlue",
        "antiquewhite",
      ];

      

      const doNothing = () => {
        window.DD_RUM.onReady(function() {
          const error = new Error("Test Error");
          console.error("Console console.error")
          window.DD_RUM.addError(error)
          window.DD_RUM.addAction("DO NOTHING CLICKED!")
        })
      }

      const colorChange = () => {
        const randomColor = Math.floor(Math.random() * colors.length);
        body.style.backgroundColor = colors[randomColor];

        // window.DD_RUM.onReady(function () {
        //   window.DD_RUM.addFeatureFlagEvaluation("testFF", "true")
        //   window.DD_RUM.startView("Home Page");
        // });
        
      };

      const getFact = async () => {
        let resp;

        try {
          window.DD_RUM.onReady(function(){
            window.DD_RUM.startDurationVital("Get_Fact");
          })
          resp = await fetch("https://catfact.ninja/fact");
          const respData = await resp.json();
          const fact = document.getElementById("catfact");

          fact.innerHTML = respData.fact;

          window.DD_RUM.onReady(function(){
            window.DD_RUM.stopDurationVital("Get_Fact");
          })
        } catch (error) {}
      };
    </script>
  </body>
</html>